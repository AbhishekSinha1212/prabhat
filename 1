
DROP TRIGGER tD_KNOWN_ISSUE
go

DROP TRIGGER tU_KNOWN_ISSUE
go

DROP TABLE SUPPORTED_PRODUCT_KNOWN_ISSUE
go

DROP TABLE SUPPORTED_PRODUCT_PROBLEM
go

DROP TABLE SUPPORTED_PRODUCT
go

DROP TABLE CALL
go

DROP TABLE PROBLEM
go

DROP TABLE SUPPORT_REPRESENTATIVE
go

DROP TABLE KNOWN_ISSUE
go

DROP TABLE PERSONAL_CHECK
go

DROP TABLE MONEY_ORDER
go

DROP TABLE CREDIT_CARD
go

DROP TABLE HARDWARE
go

DROP TABLE TRAINING_COURSE
go

DROP TABLE lineitem
go

DROP TABLE SLSORD
go

DROP TABLE NEW_EMP_TABLE
go

DROP TABLE PAYMENT
go

DROP TABLE CUSTOMER_SUPPORT_CONTRACT
go

DROP TABLE CUSTOMER
go

DROP TABLE SUPPORT_CONTRACT
go

DROP TABLE NEW_PRODUCT
go

CREATE TABLE CALL
( 
	call_number          char(8)  NOT NULL ,
	problem_number       integer  NOT NULL ,
	support_representative_code char(5)  NOT NULL ,
	call_contact_first_name varchar(15)  NULL ,
	call_contact_last_name varchar(25)  NULL ,
	call_contact_phone_number char(10)  NULL ,
	call_notes           VARCHAR(250)  NULL ,
	call_reason_code     char(2)  NULL 
	CONSTRAINT call_reason_code
		CHECK  ( [call_reason_code]='NP' OR [call_reason_code]='CI' OR [call_reason_code]='RS' OR [call_reason_code]='SC' OR [call_reason_code]='OT' ),
	call_datetime        DATE  NULL 
)
go

CREATE TABLE CREDIT_CARD
( 
	CREDIT_CARD_NUMBER   integer  NULL ,
	CREDIT_CARD_EXPIRA   DATE  NULL ,
	CREDIT_CARD_TYPE     char(1)  NULL ,
	CREDIT_CARD_NAME_O   char(30)  NULL ,
	PAYMENT_NUMBER       integer  NOT NULL ,
	credit_card_amount   char(18)  NULL 
)
go

CREATE TABLE CUSTOMER
( 
	CUSTOMER_ID          integer  NOT NULL ,
	FIRST_NAME           varchar(15)  NULL ,
	LAST_NAME            varchar(25)  NULL ,
	STREET_ADDRESS       varchar(20)  NULL ,
	customer_company_name__2 varchar(200)  NULL ,
	CITY                 varchar(20)  NULL ,
	STATE__2             char(2)  NULL 
	CONSTRAINT state_code_32413554
		CHECK  ( [STATE__2]='AL' OR [STATE__2]='AZ' OR [STATE__2]='CA' OR [STATE__2]='DE' OR [STATE__2]='FL' OR [STATE__2]='NJ' OR [STATE__2]='NY' OR [STATE__2]='TX' OR [STATE__2]='VA' ),
	ZIP_CODE             varchar(20)  NULL ,
	AREA_CODE_PHONE      integer  NULL 
	CONSTRAINT area_codes_1165452528
		CHECK  ( [AREA_CODE_PHONE]=201 OR [AREA_CODE_PHONE]=212 OR [AREA_CODE_PHONE]=215 OR [AREA_CODE_PHONE]=732 OR [AREA_CODE_PHONE]=908 ),
	PHONE_NUMBER         integer  NULL ,
	FAX_AREA_CODE        integer  NULL 
	CONSTRAINT area_codes_1619304398
		CHECK  ( [FAX_AREA_CODE]=201 OR [FAX_AREA_CODE]=212 OR [FAX_AREA_CODE]=215 OR [FAX_AREA_CODE]=732 OR [FAX_AREA_CODE]=908 ),
	FAX_NUMBER           integer  NULL 
)
go

CREATE TABLE CUSTOMER_SUPPORT_CONTRACT
( 
	PRODUCT_ID           integer  NOT NULL ,
	SUPP_CONT_NUMBER     integer  NOT NULL ,
	START_DATE           DATE  NULL ,
	END_DATE             DATE  NULL ,
	CUSTOMER_ID          integer  NULL 
)
go

CREATE TABLE HARDWARE
( 
	HW_MODEL_NAME__2     VARCHAR(20)  NULL ,
	PRODUCT_ID           integer  NOT NULL 
)
go

CREATE TABLE KNOWN_ISSUE
( 
	known_issue_number   integer  NOT NULL ,
	known_issue_description varchar(20)  NULL ,
	known_issue_workaround_description varchar(20)  NULL ,
	known_issue_status   varchar(20)  NULL 
)
go

CREATE TABLE lineitem
( 
	SALES_ORDER_NUMBER   integer  NOT NULL ,
	LINE_ITEM_SEQUENCE   integer  NOT NULL ,
	ITEM_QUANTITY        integer  NULL ,
	PRODUCT_ID           integer  NOT NULL ,
	ITEM_TOTAL           float  NULL 
)
go

CREATE TABLE MONEY_ORDER
( 
	MONEY_ORDER_NUMBER   integer  NULL ,
	PAYMENT_NUMBER       integer  NOT NULL ,
	money_order_amount   char(18)  NULL 
)
go

CREATE TABLE NEW_EMP_TABLE
( 
	EMP_NO               integer  NOT NULL ,
	EMP_FIRST_NAME       varchar(15)  NULL ,
	EMP_LAST_NAME        varchar(25)  NULL ,
	EMP_TITLE            char(20)  NULL ,
	EMP_STREET_ADDRESS   varchar(20)  NULL ,
	EMP_CITY             varchar(20)  NULL ,
	EMP_STATE            char(2)  NULL 
	CONSTRAINT state_code_1516910379
		CHECK  ( [EMP_STATE]='AL' OR [EMP_STATE]='AZ' OR [EMP_STATE]='CA' OR [EMP_STATE]='DE' OR [EMP_STATE]='FL' OR [EMP_STATE]='NJ' OR [EMP_STATE]='NY' OR [EMP_STATE]='TX' OR [EMP_STATE]='VA' ),
	EMP_ZIP_CODE         varchar(20)  NULL ,
	EMP_PHONE_AREA_COD   integer  NULL 
	CONSTRAINT area_codes_405434809
		CHECK  ( [EMP_PHONE_AREA_COD]=201 OR [EMP_PHONE_AREA_COD]=212 OR [EMP_PHONE_AREA_COD]=215 OR [EMP_PHONE_AREA_COD]=732 OR [EMP_PHONE_AREA_COD]=908 ),
	EMP_PHONE_NO         integer  NULL ,
	EMP_FAX_AREA_CODE    integer  NULL 
	CONSTRAINT area_codes_1175139473
		CHECK  ( [EMP_FAX_AREA_CODE]=201 OR [EMP_FAX_AREA_CODE]=212 OR [EMP_FAX_AREA_CODE]=215 OR [EMP_FAX_AREA_CODE]=732 OR [EMP_FAX_AREA_CODE]=908 ),
	EMP_FAX              integer  NULL ,
	EMP_SSNO             char(9)  NULL ,
	manager_id           integer  NULL 
)
go

CREATE TABLE NEW_PRODUCT
( 
	PRODUCT_ID           integer  NOT NULL ,
	PRODUCT_PRICE        float  NULL ,
	PRODUCT_DESC         VARCHAR(80)  NULL ,
	HW_MODEL_NAME        VARCHAR(20)  NULL ,
	product_type         char(18)  NULL ,
	TRN_COURSE_NAME      VARCHAR(20)  NULL ,
	TRN_COURSE_DUR       integer  NULL ,
	SUPP_CONTRACT_TYPE   char(1)  NULL ,
	SUPP_CONTRACT_TERMS  VARCHAR(20)  NULL ,
	CONSTRAINT  Product_Validation
		CHECK  ( product_id > 0 and (
  product_type = 'hardware' or 
  product_type = 'training course' or
  product_type = 'support contract') ) 
)
go

CREATE TABLE PAYMENT
( 
	PAYMENT_NUMBER       integer  NOT NULL ,
	PAYMENT_TOTAL        float  NULL ,
	PAYMENT_TIMESTAMP    DATE  NULL 
)
go

CREATE TABLE PERSONAL_CHECK
( 
	CHECK_NUMBER         integer  NULL ,
	CHECK_ACCOUNT_NO     integer  NULL ,
	CHECK_BANK_NO        integer  NULL ,
	CHECK_DRIVE_LICENS   char(20)  NULL ,
	PAYMENT_NUMBER       integer  NOT NULL ,
	check_amount         char(18)  NULL 
)
go

CREATE TABLE PROBLEM
( 
	problem_number       integer  NOT NULL ,
	known_issue_number   integer  NULL ,
	support_representative_code char(5)  NOT NULL ,
	problem_open_datetime DATE  NULL ,
	problem_description  VARCHAR(250)  NULL ,
	problem_status       char(1)  NULL ,
	problem_severity     char(1)  NULL ,
	problem_actions_taken VARCHAR(250)  NULL ,
	SALES_ORDER_NUMBER   integer  NOT NULL ,
	CUSTOMER_ID          integer  NULL 
)
go

CREATE TABLE SLSORD
( 
	SALES_ORDER_NUMBER   integer  NOT NULL ,
	SALES_ORDER_DATE     DATE  NULL ,
	SALES_ORDER_TOTAL    float  NULL ,
	SALES_ORDER_STATUS   integer  NULL 
	CONSTRAINT slsord_status_code
		CHECK  ( SALES_ORDER_STATUS BETWEEN 1 AND 5 ),
	CUSTOMER_ID          integer  NOT NULL ,
	EMP_NO               integer  NOT NULL ,
	SHIPMENT_DATE        DATE  NULL ,
	SHIPMENT_CHARGE      float  NULL ,
	SHIPMENT_METH_RATE   float  NULL ,
	SHIPMENT_METH_MIN    float  NULL ,
	SHIPMENT_METH_DESC   VARCHAR(250)  NULL ,
	PAYMENT_NUMBER       integer  NULL ,
	FIRST_NAME           varchar(15)  NULL ,
	LAST_NAME            varchar(25)  NULL ,
	STREET_ADDRESS       varchar(20)  NULL ,
	customer_company_name VARCHAR(200)  NULL ,
	CITY                 varchar(20)  NULL ,
	STATE                char(2)  NULL 
	CONSTRAINT state_code_1445994209
		CHECK  ( [STATE]='AL' OR [STATE]='AZ' OR [STATE]='CA' OR [STATE]='DE' OR [STATE]='FL' OR [STATE]='NJ' OR [STATE]='NY' OR [STATE]='TX' OR [STATE]='VA' ),
	ZIP_CODE             varchar(20)  NULL ,
	AREA_CODE_PHONE      integer  NULL 
	CONSTRAINT area_codes_1737852113
		CHECK  ( [AREA_CODE_PHONE]=201 OR [AREA_CODE_PHONE]=212 OR [AREA_CODE_PHONE]=215 OR [AREA_CODE_PHONE]=732 OR [AREA_CODE_PHONE]=908 ),
	PHONE_NUMBER         integer  NULL ,
	FAX_AREA_CODE        integer  NULL 
	CONSTRAINT area_codes_1246055643
		CHECK  ( [FAX_AREA_CODE]=201 OR [FAX_AREA_CODE]=212 OR [FAX_AREA_CODE]=215 OR [FAX_AREA_CODE]=732 OR [FAX_AREA_CODE]=908 ),
	FAX_NUMBER           integer  NULL 
)
go

CREATE TABLE SUPPORT_CONTRACT
( 
	SUPP_CONTRACT_TYPE   char(1)  NULL ,
	SUPP_CONTRACT_TERMS  VARCHAR(20)  NULL ,
	PRODUCT_ID           integer  NOT NULL 
)
go

CREATE TABLE SUPPORT_REPRESENTATIVE
( 
	support_representative_code char(5)  NOT NULL ,
	support_representative_first_name VARCHAR(15)  NULL ,
	support_representative_last_name VARCHAR(25)  NULL ,
	support_representative_level char(3)  NULL ,
	support_representative_phone_number varchar(20)  NULL ,
	support_representative_fax_number varchar(20)  NULL ,
	support_representative_email_address VARCHAR(45)  NOT NULL 
)
go

CREATE TABLE SUPPORTED_PRODUCT
( 
	supported_product_code integer  NOT NULL ,
	supported_product_manufacturer varchar(20)  NULL ,
	supported_product_name varchar(20)  NULL ,
	supported_product_description varchar(20)  NULL ,
	supported_product_category varchar(20)  NULL 
)
go

CREATE TABLE SUPPORTED_PRODUCT_KNOWN_ISSUE
( 
	supported_product_code integer  NOT NULL ,
	known_issue_number   integer  NOT NULL 
)
go

CREATE TABLE SUPPORTED_PRODUCT_PROBLEM
( 
	supported_product_code integer  NOT NULL ,
	problem_number       integer  NOT NULL 
)
go

CREATE TABLE TRAINING_COURSE
( 
	TRN_COURSE_NAME      VARCHAR(20)  NULL ,
	TRN_COURSE_DUR       integer  NULL ,
	PRODUCT_ID           integer  NOT NULL 
)
go

ALTER TABLE CALL
	ADD CONSTRAINT XPKCALL PRIMARY KEY  NONCLUSTERED (call_number,problem_number)
go

CREATE INDEX XIE1CALL ON CALL
( 
	call_contact_last_name,
	call_contact_first_name
)
go

CREATE INDEX XIE2CALL ON CALL
( 
	call_datetime       
)
go

CREATE INDEX XIE3CALL ON CALL
( 
	call_reason_code    
)
go

ALTER TABLE CREDIT_CARD
	ADD CONSTRAINT XPKCREDIT_CARD PRIMARY KEY  CLUSTERED (PAYMENT_NUMBER)
go

ALTER TABLE CUSTOMER
	ADD CONSTRAINT XPKCUST PRIMARY KEY  CLUSTERED (CUSTOMER_ID ASC)
go

CREATE NONCLUSTERED INDEX XIE1CUSTOMER ON CUSTOMER
( 
	LAST_NAME             ASC,
	FIRST_NAME            ASC
)
go

ALTER TABLE CUSTOMER_SUPPORT_CONTRACT
	ADD CONSTRAINT XPKSUPCTRCT PRIMARY KEY  CLUSTERED (SUPP_CONT_NUMBER)
go

ALTER TABLE HARDWARE
	ADD CONSTRAINT XPKHARDWARE PRIMARY KEY  CLUSTERED (PRODUCT_ID)
go

ALTER TABLE KNOWN_ISSUE
	ADD CONSTRAINT XPKKNOWN_ISSUE PRIMARY KEY  NONCLUSTERED (known_issue_number)
go

ALTER TABLE lineitem
	ADD CONSTRAINT XPKLINEITEM PRIMARY KEY  NONCLUSTERED (SALES_ORDER_NUMBER,LINE_ITEM_SEQUENCE)
go

ALTER TABLE MONEY_ORDER
	ADD CONSTRAINT XPKMONEY_ORDER PRIMARY KEY  CLUSTERED (PAYMENT_NUMBER)
go

ALTER TABLE NEW_EMP_TABLE
	ADD CONSTRAINT XPKEMP PRIMARY KEY  NONCLUSTERED (EMP_NO)
go

ALTER TABLE NEW_PRODUCT
	ADD CONSTRAINT XPKPROD PRIMARY KEY  NONCLUSTERED (PRODUCT_ID)
go

ALTER TABLE PAYMENT
	ADD CONSTRAINT XPKPAYMENT PRIMARY KEY  NONCLUSTERED (PAYMENT_NUMBER)
go

ALTER TABLE PERSONAL_CHECK
	ADD CONSTRAINT XPKPERSONAL_CHECK PRIMARY KEY  CLUSTERED (PAYMENT_NUMBER)
go

ALTER TABLE PROBLEM
	ADD CONSTRAINT XPKPROBLEM PRIMARY KEY  CLUSTERED (problem_number)
go

CREATE UNIQUE NONCLUSTERED INDEX XAK1PROBLEM ON PROBLEM
( 
	problem_number      
)
go

CREATE INDEX XIE1PROBLEM ON PROBLEM
( 
	problem_open_datetime
)
go

ALTER TABLE SLSORD
	ADD CONSTRAINT XPKSLSORD PRIMARY KEY  CLUSTERED (SALES_ORDER_NUMBER ASC)
go

ALTER TABLE SUPPORT_CONTRACT
	ADD CONSTRAINT XPKSUPPORT_CONTRACT PRIMARY KEY  CLUSTERED (PRODUCT_ID)
go

ALTER TABLE SUPPORT_REPRESENTATIVE
	ADD CONSTRAINT XPKSUPPORT_REPRESENTATIVE PRIMARY KEY  NONCLUSTERED (support_representative_code)
go

CREATE UNIQUE INDEX XAK1SUPPORT_REPRESENTATIVE ON SUPPORT_REPRESENTATIVE
( 
	support_representative_phone_number
)
go

CREATE INDEX XIE1SUPPORT_REPRESENTATIVE ON SUPPORT_REPRESENTATIVE
( 
	support_representative_last_name,
	support_representative_first_name
)
go

ALTER TABLE SUPPORTED_PRODUCT
	ADD CONSTRAINT XPKSUPPORTED_PRODUCT PRIMARY KEY  NONCLUSTERED (supported_product_code)
go

CREATE UNIQUE INDEX XAK1SUPPORTED_PRODUCT ON SUPPORTED_PRODUCT
( 
	supported_product_name
)
go

ALTER TABLE SUPPORTED_PRODUCT_KNOWN_ISSUE
	ADD CONSTRAINT XPKSUPPORTED_PRODUCT_KNOWN_ISSUE PRIMARY KEY  NONCLUSTERED (supported_product_code,known_issue_number)
go

ALTER TABLE SUPPORTED_PRODUCT_PROBLEM
	ADD CONSTRAINT XPKSUPPORTED_PRODUCT_PROBLEM PRIMARY KEY  NONCLUSTERED (supported_product_code,problem_number)
go

ALTER TABLE TRAINING_COURSE
	ADD CONSTRAINT XPKTRAINING_COURSE PRIMARY KEY  CLUSTERED (PRODUCT_ID)
go
